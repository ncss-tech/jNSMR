<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run Newhall Soil Climate Simulations — newhall_batch.default • jNSMR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run Newhall Soil Climate Simulations — newhall_batch.default"><meta property="og:description" content="newhall_batch() provides an interface to multiple runs of the jNSM BASICSimulationModel() for the CSV batch file input format used in jNSM 1.6.0, plus the SpatRaster and RasterStack R object types.
newhall_batch(&amp;lt;character&amp;gt;) - one or more paths to jNSM Comma-Separated Value '.csv' batch files; see details for required column names
newhall_batch(&amp;lt;SpatRaster&amp;gt;) - a SpatRaster object, containing the required column names as layers
newhall_batch(&amp;lt;RasterStack&amp;gt;)- a RasterStack object, containing the required column names as layers

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jNSMR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/legacy-newhall161.html">Using Legacy Newhall v1.6.1 Routines</a>
    </li>
    <li>
      <a href="../articles/newhall-prism.html">Applying Newhall to PRISM 30-year Normals for Continental United States</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ncss-tech/jNSMR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run Newhall Soil Climate Simulations</h1>
    <small class="dont-index">Source: <a href="https://github.com/ncss-tech/jNSMR/blob/HEAD/R/NewhallBatch.R" class="external-link"><code>R/NewhallBatch.R</code></a></small>
    <div class="hidden name"><code>newhall_batch.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>newhall_batch()</code> provides an interface to multiple runs of the jNSM <code><a href="BASICSimulationModel.html">BASICSimulationModel()</a></code> for the CSV batch file input format used in jNSM 1.6.0, plus the <code>SpatRaster</code> and <code>RasterStack</code> R object types.</p><ul><li><p><code>newhall_batch(&lt;character&gt;)</code> - one or more paths to jNSM Comma-Separated Value '.csv' batch files; see details for required column names</p></li>
<li><p><code>newhall_batch(&lt;SpatRaster&gt;)</code> - a <code>SpatRaster</code> object, containing the required column names as layers</p></li>
<li><p><code>newhall_batch(&lt;RasterStack&gt;)</code>- a <code>RasterStack</code> object, containing the required column names as layers</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu">newhall_batch</span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unitSystem <span class="op">=</span> <span class="st">"metric"</span>,</span>
<span>  soilAirOffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">unitSystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"in"</span>, <span class="st">"english"</span><span class="op">)</span>, <span class="fl">4.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="fl">0.66</span>,</span>
<span>  hasOHorizon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  isSaturated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  toString <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkargs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  core_thresh <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">newhall_batch</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  unitSystem <span class="op">=</span> <span class="st">"metric"</span>,</span>
<span>  soilAirOffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">unitSystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"in"</span>, <span class="st">"english"</span><span class="op">)</span>, <span class="fl">4.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="fl">0.66</span>,</span>
<span>  hasOHorizon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  isSaturated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  toString <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkargs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  core_thresh <span class="op">=</span> <span class="fl">25000L</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>  nrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for character</span></span>
<span><span class="fu">newhall_batch</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  unitSystem <span class="op">=</span> <span class="st">"metric"</span>,</span>
<span>  soilAirOffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">unitSystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"in"</span>, <span class="st">"english"</span><span class="op">)</span>, <span class="fl">4.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="fl">0.66</span>,</span>
<span>  hasOHorizon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  isSaturated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  toString <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkargs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  core_thresh <span class="op">=</span> <span class="fl">25000L</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>  nrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for SpatRaster</span></span>
<span><span class="fu">newhall_batch</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  unitSystem <span class="op">=</span> <span class="st">"metric"</span>,</span>
<span>  soilAirOffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">unitSystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"in"</span>, <span class="st">"english"</span><span class="op">)</span>, <span class="fl">4.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="fl">0.66</span>,</span>
<span>  hasOHorizon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  isSaturated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  toString <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  checkargs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  core_thresh <span class="op">=</span> <span class="fl">25000L</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>  nrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span><span class="op">/</span><span class="va">core_thresh</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for RasterBrick</span></span>
<span><span class="fu">newhall_batch</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  unitSystem <span class="op">=</span> <span class="st">"metric"</span>,</span>
<span>  soilAirOffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">unitSystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"in"</span>, <span class="st">"english"</span><span class="op">)</span>, <span class="fl">4.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="fl">0.66</span>,</span>
<span>  hasOHorizon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  isSaturated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  toString <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkargs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  core_thresh <span class="op">=</span> <span class="fl">25000L</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>  nrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">core_thresh</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span></span>
<span>    <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">core_thresh</span> <span class="op">*</span> <span class="va">cores</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for RasterStack</span></span>
<span><span class="fu">newhall_batch</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  unitSystem <span class="op">=</span> <span class="st">"metric"</span>,</span>
<span>  soilAirOffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">unitSystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"in"</span>, <span class="st">"english"</span><span class="op">)</span>, <span class="fl">4.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="fl">0.66</span>,</span>
<span>  hasOHorizon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  isSaturated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  toString <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkargs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  core_thresh <span class="op">=</span> <span class="fl">25000L</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>  nrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">core_thresh</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span></span>
<span>    <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.data</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">core_thresh</span> <span class="op">*</span> <span class="va">cores</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.data</dt>
<dd><p>a <em>data.frame</em> or <em>character</em> vector of paths to CSV files; or a SpatRaster or RasterStack containing the same data elements and names as included in the batch <code>data.frame</code>/CSV format</p></dd>


<dt>unitSystem</dt>
<dd><p>Default: <code>"metric"</code> OR <code>"mm"</code> OR <code>"cm"</code> use <em>millimeters</em> of rainfall (default for the BASIC model); set to <code>unitSystem="english"</code> OR <code>unitSystem="in"</code> to transform English (inches of precipitation; degrees Fahrenheit) inputs to metric (millimeters of precipitation; degrees Celsius) before running simulation</p></dd>


<dt>soilAirOffset</dt>
<dd><p>air-soil temperature offset. Conventionally for jNSM: <code>2.5</code> for metric units (default); <code>4.5</code> for english units. Can optionally be specified as a layer in a raster input.</p></dd>


<dt>amplitude</dt>
<dd><p>difference in amplitude between soil and air temperature sine waves. Default <code>0.66</code>. Can optionally be specified as a layer in a raster input.</p></dd>


<dt>hasOHorizon</dt>
<dd><p>Used for cryic soil temperature regime criteria. Default: <code>FALSE</code>. Can optionally be specified as a layer in a raster input.</p></dd>


<dt>isSaturated</dt>
<dd><p>Used for cryic soil temperature regime and aquic soil moisture regime mask. Default: <code>FALSE</code>. Can optionally be specified as a layer in a raster input.</p></dd>


<dt>verbose</dt>
<dd><p>print message about number of simulations and elapsed time</p></dd>


<dt>toString</dt>
<dd><p>call <code><a href="https://rdrr.io/r/base/toString.html" class="external-link">toString()</a></code> method on each <em>NewhallResults</em> object and store in <code>output</code> column of result?</p></dd>


<dt>checkargs</dt>
<dd><p><em>logical</em>; check argument length and data types for each run? Default: <code>TRUE</code></p></dd>


<dt>cores</dt>
<dd><p>integer. Number of cores; used only for processing <em>SpatRaster</em> or <em>Raster*</em> input. Default: <code>1</code> processes batches sequentially.</p></dd>


<dt>core_thresh</dt>
<dd><p>integer. Approximate number of cells to target per core and batch; used to calculate default value for <code>nrows</code>. Default <code>25000</code> cells.</p></dd>


<dt>file</dt>
<dd><p>character. Path to write incremental raster processing output for large inputs that do not fit in memory; passed to <code><a href="https://rdrr.io/pkg/terra/man/readwrite.html" class="external-link">terra::writeStart()</a></code> and used only for processing <em>SpatRaster</em> or <em>Raster*</em> input; defaults to a temporary file created by <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile()</a></code> if needed</p></dd>


<dt>nrows</dt>
<dd><p>integer. Number of rows to use per block; passed to <code><a href="https://rdrr.io/pkg/terra/man/readwrite.html" class="external-link">terra::readValues()</a></code> <code><a href="https://rdrr.io/pkg/terra/man/readwrite.html" class="external-link">terra::writeValues()</a></code>; used only for processing <em>SpatRaster</em> or <em>Raster*</em> input; defaults to number of rows in <code>.data</code> if it is small. If the number of cells in <code>.data</code> exceeds <code>core_thresh</code>, then the number of rows is calculated based on the number of cells in <code>.data</code>, <code>core_thresh</code> and <code>cores</code>.</p></dd>


<dt>overwrite</dt>
<dd><p>logical. Overwrite <code>file</code>? passed to <code><a href="https://rdrr.io/pkg/terra/man/readwrite.html" class="external-link">terra::writeStart()</a></code>; defaults to <code>TRUE</code> if needed</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>When input is a <em>data.frame</em> or <em>character</em> vector of paths to CSV files, result is a a <em>data.frame</em> with key model outputs (see details) containing list columns with Java Objects for <em>NewhallDataset</em>, <em>NewhallResults</em>.  If <code>toString=TRUE</code> the column <code>output</code> is a <em>character</em> containing the <code><a href="https://rdrr.io/r/base/toString.html" class="external-link">toString()</a></code> output from <em>NewhallResults</em></p>



<p>For <code>SpatRaster</code> input returns a <code>SpatRaster</code> containing numeric and categorical model outputs. <code>RasterBrick</code> inputs are first converted to <code>SpatRaster</code>, and a <code>SpatRaster</code> is returned</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
<div class="section">
<h3 id="required-inputs">Required inputs<a class="anchor" aria-label="anchor" href="#required-inputs"></a></h3>


<p>The main inputs to the model are monthly precipitation and air temperature for each site, the location, the soil available water storage, and the elevation.</p>
<p>The following columns and names are required in the input data/object:</p><ul><li><p>Latitude and Longitude in WGS84 Decimal Degrees: "latDD", "lonDD"</p></li>
<li><p>Monthly Air Temperature (degrees C or F): "tJan", "tFeb", "tMar", "tApr", "tMay", "tJun", "tJul", "tAug", "tSep", "tOct", "tNov", "tDec"</p></li>
<li><p>Monthly Precipitation (millimeters or inches of rain): "pJan", "pFeb", "pMar", "pApr", "pMay", "pJun", "pJul", "pAug", "pSep", "pOct", "pNov", "pDec"</p></li>
<li><p>Profile Available Water Storage (millimeters; Default <code>200</code>): "awc"</p></li>
<li><p>Elevation (meters or feet): "elev"</p></li>
</ul></div>

<div class="section">
<h3 id="dry-v-s-moist">Dry v.s. Moist<a class="anchor" aria-label="anchor" href="#dry-v-s-moist"></a></h3>


<p>The concept of "dry" versus "moist" is expressed semi-quantitatively in the Newhall model with three different categories of moisture being recognized: "moist", "moist/dry" and "dry."</p>
<p>Of interest to the classification of climate regimes of a soil are not only when/where the soil is dry but how that moisture or lack thereof corresponds with prevailing temperature conditions.</p>
</div>

<div class="section">
<h3 id="standard-model-output-fields-and-their-definitions-in-the-latest-available-jar-file-include-">Standard model output fields and their definitions in the latest available JAR file include:<a class="anchor" aria-label="anchor" href="#standard-model-output-fields-and-their-definitions-in-the-latest-available-jar-file-include-"></a></h3>

<ul><li><p><code>"annualRainfall"</code> - sum of monthly precipitation values over the year</p></li>
<li><p><code>"waterHoldingCapacity"</code> - total water storage of soil profile in units of length (<code>mm</code>). Default: <code>200</code> millimeters (8 inches) of water storage. This is approximately the average water storage when calculated using SSURGO available water capacities and depths for the soils in CONUS.</p></li>
<li><p><code>"annualWaterBalance"</code> - sum of difference of precipitation and estimated mean potential evapotranspiration (Thornthwaite, 1948) by month</p></li>
<li><p><code>"annualPotentialEvapotranspiration"</code> - sum of mean monthly potential evapotranspiration (Thornthwaite, 1948)</p></li>
<li><p><code>"summerWaterBalance"</code> - sum of (summer months only) difference of precipitation and estimated mean potential evapotranspiration by month</p></li>
<li><p><code>"dryDaysAfterSummerSolstice"</code> - number of days "dry" after June 21; used in definition of Xeric moisture regime</p></li>
<li><p><code>"moistDaysAfterWinterSolstice"</code> - number of days "moist" after December 21; used in definition of Xeric moisture regime</p></li>
<li><p><code>"numCumulativeDaysDry"</code> - cumulative number of "dry" days per year</p></li>
<li><p><code>"numCumulativeDaysMoistDry"</code> - cumulative number of days "intermediate between moist and dry" per year</p></li>
<li><p><code>"numCumulativeDaysMoist"</code> - cumulative number of days "moist" per year</p></li>
<li><p><code>"numCumulativeDaysDryOver5C"</code> - cumulative number of days "dry" per year when the <em>soil temperature is over 5 degrees C</em></p></li>
<li><p><code>"numCumulativeDaysMoistDryOver5C"</code> - cumulative number of days "intermediate between moist and dry" per year when the <em>soil temperature is over 5 degrees C</em></p></li>
<li><p><code>"numCumulativeDaysMoistOver5C"</code> - cumulative number of days "moist" per year when the <em>soil temperature is over 5 degrees C</em></p></li>
<li><p><code>"numConsecutiveDaysMoistInSomeParts"</code> - maximum number of consecutive days per year where some parts of the profile are "moist"</p></li>
<li><p><code>"numConsecutiveDaysMoistInSomePartsOver8C"</code> - maximum number of consecutive days per year where some parts of the profile are "moist" <em>and</em> the <em>soil temperature is over 8 degrees C</em></p></li>
<li><p><code>"temperatureRegime"</code> - estimated Soil Temperature Regime; one of "Pergelic", "Cryic", "Frigid", "Mesic", "Thermic", "Hyperthermic", "Isofrigid", "Isomesic", "Isothermic", or "Isohyperthermic"</p></li>
<li><p><code>"moistureRegime"</code> - estimated Soil Moisture Regime; one of "Aridic", "Ustic", "Xeric", "Udic", "Perudic", or "Undefined"</p></li>
<li><p><code>"regimeSubdivision1"</code> - estimated "Moisture Regime Subdivision #1"; one of "Typic", "Weak", "Wet", "Dry", "Extreme", "Xeric", "Udic", "Aridic", or " " (See van Wambecke et al., 1981)</p></li>
<li><p><code>"regimeSubdivision2"</code> - estimated "Moisture Regime subdivision #2"; one of "Aridic", "Tempustic", "Tropustic", "Tempudic", "Xeric", "Udic", "Tropudic", "Undefined",  or " " (See van Wambecke et al., 1981)</p></li>
</ul><p>"Years" are based on uniform 12 months with 30 days each for a total of 360 days (no leap years).</p>
<p>The following elements have a many:1 relationship with model runs and are not (yet) included in the standard output, but can be accessed using an rJava object reference to a <code>NewhallResults</code> class.</p><ul><li><p><code>"meanPotentialEvapotranspiration"</code> - estimated mean monthly potential evapotranspiration (Thornthwaite, 1948)</p></li>
<li><p><code>"temperatureCalendar"</code> - compressed (360 day) grid "calendar" showing days above 5 and 8 degrees C</p></li>
<li><p><code>"moistureCalendar"</code> - compressed (360 day) grid "calendar" showing "moist", "moist/dry" and "dry" days.</p></li>
</ul></div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>van Wambeke, A. and Newhall, F. and United States Soil Management Support Services (1981) Calculated Soil Moisture and Temperature Regimes of South America: A Compilation of Soil Climatic Regimes calculated by using a mathematical model developed by F. Newhall (Soil Conservation Service, USDA, 1972). SMSS : Technical Monograph : Soil management support services. New York State College of Agriculture and Life Sciences, Cornell University, Department of Agronomy. Available online: <a href="https://books.google.com/books?id=jwtIAAAAYAAJ" class="external-link">https://books.google.com/books?id=jwtIAAAAYAAJ</a></p>
<p>Thornthwaite, C. W. (1948). An Approach toward a Rational Classification of Climate. Geographical Review, 38(1), 55–94. https://doi.org/10.2307/210739</p>
<p>Newhall, F., Berdanier, C. (1996) Calculation of soil moisture regimes from the climatic record. National Soil Survey Center, Natural Resources Conservation Service, U.S. Dept. of Agriculture. Available online: <a href="https://www.nrcs.usda.gov/Internet/FSE_DOCUMENTS/nrcs142p2_052248.pdf" class="external-link">https://www.nrcs.usda.gov/Internet/FSE_DOCUMENTS/nrcs142p2_052248.pdf</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><code><a href="BASICSimulationModel.html">BASICSimulationModel()</a></code>: create an instance of the Java Newhall Simulation Model</p></li>
<li><p><code><a href="newhall_simulation.html">newhall_simulation()</a></code>: run a single Newhall model instance, return <code>NewhallResults</code> object</p></li>
</ul></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> terra 1.7.46</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"prism_issr800_sample.tif"</span>, package<span class="op">=</span><span class="st">"jNSMR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## optional: make larger extent (requires full cache)</span></span></span>
<span class="r-in"><span><span class="co"># x &lt;- c(newhall_prism_extent(ext(x) * 4), newhall_issr800_extent(ext(x) * 4))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">$</span><span class="va">elev</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># elevation is not currently used by the model directly</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reduce resolution (for fast example)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">10</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate winter, summer and annual average temperatures</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">$</span><span class="va">mwst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tDec"</span>,<span class="st">"tJan"</span>,<span class="st">"tFeb"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">$</span><span class="va">msst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tJun"</span>,<span class="st">"tJul"</span>,<span class="st">"tAug"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">$</span><span class="va">mast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="va">month.abb</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">$</span><span class="va">dif</span> <span class="op">&lt;-</span> <span class="va">x2</span><span class="op">$</span><span class="va">msst</span> <span class="op">-</span> <span class="va">x2</span><span class="op">$</span><span class="va">mwst</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x2</span><span class="op">$</span><span class="va">dif</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="newhall_batch-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1/10th resolution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span> <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">newhall_batch</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> newhall_batch: ran n=204 simulations in 0.52 secs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.024   0.044   0.713 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ~1/3 resolution</span></span></span>
<span class="r-in"><span><span class="co"># system.time({  y &lt;- newhall_batch(aggregate(x, 3)) })</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## full resolution</span></span></span>
<span class="r-in"><span><span class="co"># system.time({  y &lt;- newhall_batch(x) })</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">annualWaterBalance</span>, main <span class="op">=</span> <span class="st">"Annual Water Balance (P-PET)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">waterHoldingCapacity</span>, main <span class="op">=</span> <span class="st">"Water Holding Capacity"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="newhall_batch-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">temperatureRegime</span>, main <span class="op">=</span> <span class="st">"Temperature Regime"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">moistureRegime</span>, main <span class="op">=</span> <span class="st">"Moisture Regime"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="newhall_batch-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">numCumulativeDaysDryOver5C</span>, cex.main<span class="op">=</span><span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>            main <span class="op">=</span> <span class="st">"# Cumulative Days Dry over 5 degrees C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">numConsecutiveDaysMoistInSomePartsOver8C</span>, cex.main<span class="op">=</span><span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>            main <span class="op">=</span> <span class="st">"# Consecutive Days Moist\nin some parts over 8 degrees C"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="newhall_batch-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>            </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrew Brown.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

